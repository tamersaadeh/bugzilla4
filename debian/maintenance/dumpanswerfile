#!/usr/bin/env perl
# http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=594583

use Debconf::Client::ConfModule ':all';
use Data::Dumper;

version("2.0");
$admin_email = get("bugzilla4/bugzilla_admin_name");
$admin_realname = get("bugzilla4/bugzilla_admin_real_name");
$admin_password = get("bugzilla4/bugzilla_admin_pwd");

$ENV{BUGZILLA_DATADIR} ||= "/var/lib/bugzilla4/data";
open (my $F, ">" . $ENV{BUGZILLA_DATADIR} . "/answerfile") || die $!;
print $F <<EOT;
# DO NOT EDIT THIS FILE -- THIS FILE IS AUTO GENERATED
# TO UPDATE THIS VALUES PLEASE RUN (AS root) THE FOLLOWING COMMAND
#   /usr/share/bugzilla4/contrib/dumpanswerfile
# TO CHANGE THE VALUES RUN
#   dpkg-reconfigure bugzilla4
EOT
print $F Data::Dumper->Dump([$admin_email, $admin_realname, $admin_password], ["*answer{'ADMIN_EMAIL'}", "*answer{'ADMIN_REALNAME'}", "*answer{'ADMIN_PASSWORD'}"]) . "\n";
close ($F);
